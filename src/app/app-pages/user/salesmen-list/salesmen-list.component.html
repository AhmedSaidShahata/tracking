<div class="page-title">
  <div class="row">
    <div class="col-sm-6">
      <h4 class="mb-0"> {{ 'control_assets' | translate }}
      </h4>
    </div>
    <div class="col-sm-6">
      <ol class="breadcrumb pt-0 float-left float-sm-right ">
        <li class="breadcrumb-item"><a href="javascript:void(0);" class="default-color">{{ 'assets' | translate }}</a>
        </li>
        <li class="breadcrumb-item active">{{ 'control_assets' | translate }}</li>
      </ol>
    </div>
  </div>
</div>
<!-- main body -->
<div class="row">
  <div class="col-xl-12 mb-30">
    <div class="card card-statistics h-100">
      <div class="card-body">
        <h5 class="card-title mb-0">{{ 'search_in_assets' | translate }}</h5>

        <div class="form-row">

          <div class="form-group col-md-3">
            <label>{{ 'serial_number' | translate }}</label>
            <input type="text" class="form-control" [(ngModel)]="serial_number"
                   placeholder="{{ 'serial_number' | translate }}">
          </div>


          <div class="form-group col-md-3">
            <label>{{ 'QR' | translate }}</label>
            <input type="text" class="form-control" [(ngModel)]="QR"
                   placeholder="{{ 'QR' | translate }}">
          </div>


          <div class="form-group col-md-3">
            <label> {{ 'electronic_id' | translate }}</label>
            <input type="text" class="form-control" [(ngModel)]="electronic_id"
                   placeholder="{{ 'electronic_id' | translate }}">
          </div>


          <div class="form-group col-md-3">
            <label> {{ 'main_department' | translate }} </label>
            <select class="form-control" [(ngModel)]="selectedMainCat" (change)="getAllSubCat($event)">
              <option value="">{{ 'select' | translate }}</option>
              <option *ngFor="let obj of main_categories" [value]="obj.Id">{{obj | translate }}</option>
            </select>
          </div>


          <div class="form-group col-md-3" *ngIf="selectedMainCat != ''">
            <label> {{ 'category' | translate }} </label>

            <select class="form-control" [(ngModel)]="selectedSubcat" (change)="getModel($event)">
              <option value="">{{ 'select' | translate }}</option>

              <option *ngFor="let obj of sub_category" [value]="obj.Id">{{obj | translate }}</option>


            </select>
          </div>


          <div class="form-group col-md-3" *ngIf="selectedSubcat != ''">

            <label> {{ 'model' | translate }} </label>

            <select class="form-control" [(ngModel)]="selectedModel">
              <option value="">{{ 'select' | translate }}</option>
              <option *ngFor="let obj of models" [value]="obj.Id">{{obj | translate }}</option>

            </select>
          </div>


          <div class="form-group col-md-3">
            <label> {{ 'status' | translate }} </label>
            <select class="form-control" [(ngModel)]="selectedstatus">
              <option value="">{{ 'select' | translate }}</option>
              <option *ngFor="let obj of status" [value]="obj.Id">{{obj | translate }}</option>

            </select>
          </div>


          <div class="form-group col-md-3">
            <label> {{ 'location' | translate }} </label>
            <select class="form-control" [(ngModel)]="selectedLocation" (change)="getBuild($event)">
              <option value="">{{ 'select' | translate }}</option>
              <option *ngFor="let obj of locations" [value]="obj.Id">{{obj | translate }}</option>

            </select>
          </div>


          <div class="form-group col-md-3">
            <label>  {{ 'Priority' | translate }} </label>
            <select required name="Priority" class="form-control"
                    [(ngModel)]="selectedPriority">
              <option value="">{{ 'select' | translate }}</option>
              <option value="LOW">{{'LOW' | translate }}</option>
              <option value="MEDIUM">{{'MEDIUM' | translate }}</option>
              <option value="HIGH">{{'HIGH' | translate }}</option>

            </select>

          </div>



          <div class="form-group col-md-3" *ngIf="selectedLocation != ''">
            <label> {{ 'building' | translate }} </label>
            <select class="form-control" [(ngModel)]="selectedTowers" (change)="getFloors($event)">
              <option value="">{{ 'select' | translate }}</option>
              <option *ngFor="let obj of towers" [value]="obj.Id">{{obj | translate }}</option>


            </select>
          </div>


          <div class="form-group col-md-3" *ngIf="selectedTowers != ''">
            <label> {{ 'floors' | translate }} </label>
            <select class="form-control" [(ngModel)]="selectedFloors" (change)="getFloorRooms($event)">
              <option value="">{{ 'select' | translate }}</option>
              <option *ngFor="let obj of floors" [value]="obj.Id">{{obj | translate }}</option>

            </select>
          </div>


          <div class="form-group col-md-3" *ngIf="selectedFloors != ''">
            <label> {{ 'offices' | translate }} </label>
            <select class="form-control" [(ngModel)]="selectedRoom">
              <option value="">{{ 'select' | translate }}</option>
              <option *ngFor="let obj of rooms" [value]="obj.Id">{{obj | translate }}</option>

            </select>
          </div>

          <div class="form-group col-md-3">
            <label> {{ 'assigners' | translate }} </label>


            <ng-select
              placeholder="{{ 'select' | translate }}"

              [(ngModel)]="selectedAssigner">
              <ng-option *ngFor="let obj of assigners" [value]="obj.Id">{{obj | translate }}  - {{obj.Email }} </ng-option>

            </ng-select>


          </div>

          <div class="form-group col-md-3">
            <label> {{ 'assigned_to' | translate }} </label>


            <ng-select
              placeholder="{{ 'select' | translate }}"

              [(ngModel)]="selectedAssignedTo">
              <ng-option *ngFor="let obj of assignedTo" [value]="obj.Id">{{obj | translate }} - {{obj.Email }} </ng-option>

            </ng-select>


          </div>


          <div class="form-group col-md-3">
            <label> {{ 'received' | translate }} </label>
            <select class="form-control" [(ngModel)]="userRecive">
              <option value="0">{{ 'select' | translate }}</option>
              <option value="1">{{ 'Yes' | translate }}</option>
              <option value="2">{{ 'No' | translate }}</option>


            </select>
          </div>


          <div class="form-group col-md-3">
            <label> {{ 'creator' | translate }} </label>


            <ng-select
              placeholder="{{ 'select' | translate }}"

              [(ngModel)]="selectedCreator">
              <ng-option *ngFor="let obj of assigners" [value]="obj.Id">{{obj | translate }} - {{obj.Email }}</ng-option>

            </ng-select>
          </div>


          <div class="form-group col-md-3">
            <label> {{ 'date_from' | translate}} </label>
            <div class="input-group">
              <input class="form-control" placeholder="yyyy-mm-dd"
                     name="date_from" ngbDatepicker #s="ngbDatepicker" [(ngModel)]="date_from">
              <div class="input-group-append">
                <button class="btn btn-secondary" (click)="s.toggle()" type="button">
                  <i class="fa fa-calendar"></i>
                </button>
              </div>
            </div>


          </div>


          <div class="form-group col-md-3">
            <label> {{ 'date_to' | translate}} </label>
            <div class="input-group">
              <input class="form-control" placeholder="yyyy-mm-dd"
                     name="date_to" ngbDatepicker #d="ngbDatepicker" [(ngModel)]="date_to">
              <div class="input-group-append">
                <button class="btn btn-secondary" (click)="d.toggle()" type="button">
                  <i class="fa fa-calendar"></i>
                </button>
              </div>
            </div>


          </div>


          <div class="form-group col-md-3">
            <label> {{ 'return_date' | translate}} </label>
            <div class="input-group">
              <input class="form-control" placeholder="yyyy-mm-dd"
                     name="return_date" ngbDatepicker #d="ngbDatepicker" [(ngModel)]="return_date">
              <div class="input-group-append">
                <button class="btn btn-secondary" (click)="d.toggle()" type="button">
                  <i class="fa fa-calendar"></i>
                </button>
              </div>
            </div>


          </div>


        </div>

        <div class="row  justify-content-center">
          <!--<button type="button" class="btn btn-success btn-lg col-md-2" style="margin: 10px">أضافة</button>-->

          <button type="button" (click)="SearchAsset()" class="btn btn-primary  btn-lg  col-md-2 center-block"
                  style="margin: 10px">{{ 'search' | translate }}
          </button>
          <button type="button" (click)="printAsset()" class="btn btn-warning btn-lg  col-md-2 center-block"
                  style="margin: 10px">{{ 'export_report' | translate }}
          </button>






          <button type="button" (click)="ClearAll()" class="btn btn-danger btn-lg col-md-2 center-block"
                  style="margin: 10px">{{ 'clear' | translate }}
          </button>


        </div>


      </div>
    </div>
  </div>
</div>


<app-addnew-asset #addcomponent>

</app-addnew-asset>


<app-follow-asset #followasset>

</app-follow-asset>

<div class="row">
  <div class="col-xl-12 mb-30">
    <div class="card card-statistics h-100">
      <div class="card-body">
        <h5 class="card-title mb-0">{{ 'assets_list' | translate }}

          /

          {{ 'number_asset' | translate }} ({{count}})
        </h5>
        <div class="row justify-content-center">


          <div class="form-group col-md-4">

            <button type="button" (click)="showAddNewItem()" class="btn btn-primary  btn-lg btn-block"
                    style="margin: 10px">{{ 'add_new_asset' | translate }}
            </button>



          </div>



                    <div class="form-group col-md-4">



            <button type="button" (click)="importExcelfile()" class="btn btn-primary  btn-lg btn-block"
                    style="margin: 10px">{{ 'excel_assets' | translate }}

              <input type="file" id="fileexplore" style="display:none" (change)="importExcel($event)">

            </button>



          </div>






          <div class="form-group col-md-4" *ngIf="false">

            <a class="button button-border black btn-block"> {{ 'upload_asset_file' | translate }} </a>
          </div>
          <div class="form-group col-md-4">


            <button type="button" (click)="attachAssets()" class="btn btn-primary  btn-lg btn-block"
                    style="margin: 10px">{{ 'attach_assets' | translate }}







              <div class="float-right" *ngIf="this.selectedAttachAssets.length > 0">
                <span class="badge badge-pill badge-success">{{this.selectedAttachAssets.length}}</span>
              </div>
            </button>





          </div>
        </div>

        <div class="table-responsive">
          <table class="table table-1 table-bordered table-striped mb-0">
            <thead>
            <tr>
              <th>
                #
              </th>
              <th>{{ 'serial_number' | translate }}</th>
              <th>{{ 'main_department' | translate }}</th>
              <th>{{ 'category' | translate }}</th>
              <th>{{ 'model' | translate }}</th>
              <th>{{ 'status' | translate }}</th>
              <th>{{ 'location' | translate }}</th>
              <th>{{ 'building' | translate }}</th>
              <th>{{ 'floor' | translate }}</th>
              <th>{{ 'offices_select' | translate }}</th>
              <th>{{ 'print_status' | translate }}</th>
              <th>{{ 'attachment' | translate }}</th>
              <th>{{ 'name_attached' | translate }}</th>
              <th>{{ 'received' | translate }}</th>
              <th>{{ 'options' | translate }}</th>
            </tr>
            </thead>
            <tbody>

            <tr *ngFor="let item of assets;let i = index">

              <td>
                <input *ngIf="item.IsAssigned != 1 "


                       (change)="item.selectedAttach = !item.selectedAttach"
                       (change)="onChangeAsset(item,$event) "


                       type="checkbox" [checked]="item.IsAssigned == 1 || item.selectedAttach" class="remember-checkbox"

                />

                <input *ngIf="item.IsAssigned == 1 "


                       disabled="true"


                       type="checkbox" [checked]="item.IsAssigned == 1 || item.selectedAttach" class="remember-checkbox"

                />

                <!--[disabled]="item.IsAssigned == 1" [(ngModel)]="item.checkForEmp"-->
              </td>


              <td>{{item.SerialNumber}}</td>


              <td>{{item.main_category | translate}}</td>
              <td>{{item.category | translate}}</td>
              <td>{{item.model | translate}}</td>

              <td>{{item.status | translate}}</td>


              <td>{{item.location | translate}}</td>
              <td>{{item.tower | translate}}</td>
              <td>{{item.floor | translate}}</td>
              <td>{{item.room | translate}}</td>

              <td>
                <input type="checkbox" [checked]="item.IsPrinted == 1" class="remember-checkbox" disabled
                />
              </td>
              <td>
                <input type="checkbox" [checked]="item.IsAssigned == 1" class="remember-checkbox" disabled
                />
              </td>


              <td>{{item.employee | translate}}</td>
              <td>{{getAttachedName(item.IsReceived )}}</td>


              <td>

                <a (click)="editAsset(item,i)" class="dropdown-item" href="javascript:void(0);">
                  <i class="text-dark ti-pencil-alt"></i> {{ 'edit' | translate }}</a>



                <div class="d-block" ngbDropdown #myDrop="ngbDropdown">
                  <button class="btn btn-secondary" id="dropdownManual"
                          ngbDropdownAnchor (focus)="myDrop.open()">{{ 'options' | translate }}
                  </button>
                  <div ngbDropdownMenu aria-labelledby="dropdownManual">
                    <a (click)="editAsset(item,i)" class="dropdown-item" href="javascript:void(0);">
                      <i class="text-dark ti-pencil-alt"></i> {{ 'edit' | translate }}</a>
                    <a appCanDelete (click)="deleteAsset(item,i)" class="dropdown-item" href="javascript:void(0);">
                      <i class="text-primary ti-trash"></i> {{ 'delete' | translate }}</a>
                    <a class="dropdown-item" (click)="showFollowItem(item)"><i
                      class="text-success ti-user"></i> {{ 'follow' | translate }} </a>

                    <!--<a (click)="printeAsset(item,i)" class="dropdown-item" href="javascript:void(0);"><i-->
                      <!--class="text-success ti-printer"></i> {{ 'print' | translate }}</a>-->
                    <!---->
                    <!---->
                    <a *ngIf="item.IsAssigned != 1 " (click)="changeStatusToMissing(item,i)" class="dropdown-item"
                       href="javascript:void(0);">
                      <i class="text-success  ti-share"></i> {{ 'change_status_to_missing' | translate }}</a>
                    <a *ngIf="item.IsAssigned != 1 " (click)="changeStatusToCorrupted(item,i)" class="dropdown-item"
                       href="javascript:void(0);">
                      <i class="text-success ti-share-alt"></i> {{ 'change_status_to_corrupted' | translate }}</a>

                    <a *ngIf="item.IsAssigned != 1 " (click)="usedBefore(item,i)" class="dropdown-item"
                       href="javascript:void(0);">
                      <i class="text-success ti-more"></i> {{ 'used_before' | translate }}</a>

                    <a *ngIf="item.IsAssigned == 1 " (click)="pullAsset(item,i)" class="dropdown-item"
                       href="javascript:void(0);">
                      <i class="text-secondary ti-desktop"></i>
                      {{ 'pull_asset' | translate }}</a>
                  </div>
                </div>


              </td>
            </tr>

            </tbody>
          </table>

          <div class="sm-mt-20" style="margin-top: 20px">
            <nav aria-label="Page navigation example">
              <ul class="pagination justify-content-center">


                <ngb-pagination [maxSize]="10" [directionLinks]="true"


                                [pageSize]="10" (pageChange)="SearchAssetPage($event)" [collectionSize]="count"
                                aria-label="Default pagination"></ngb-pagination>


              </ul>
            </nav>
          </div>

        </div>


      </div>
    </div>
  </div>


</div>
